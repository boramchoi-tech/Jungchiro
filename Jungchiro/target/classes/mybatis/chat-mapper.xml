<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="chat">

	<insert id="createRoom" parameterType="chatDto">
		INSERT INTO CHAT VALUES
		(CHAT_SEQ.NEXTVAL, #{chat_name}, #{chat_category}, SYSDATE)
		<selectKey keyProperty="chat_seq" resultType="int" order="AFTER">
			SELECT CHAT_SEQ.CURRVAL as CHAT_SEQ from dual
		</selectKey>
	</insert>

	<insert id="insertChatList" parameterType="int">
		INSERT INTO MEMBER_CHAT VALUES(#{member_seq}, #{chat_seq}, SYSDATE)
	</insert>

	<select id="myChatList" parameterType="int" resultType="chatDto">
		SELECT A.CHAT_SEQ, A.CHAT_NAME, A.CHAT_CATEGORY, A.CHAT_MAKEDAY, B.MEMBER_SEQ, B.MEMBER_CHAT_OUTTIME FROM CHAT A, MEMBER_CHAT B
		WHERE
			A.CHAT_SEQ = B.CHAT_SEQ
		AND MEMBER_SEQ = #{member_seq}
		ORDER BY B.MEMBER_CHAT_OUTTIME DESC
	</select>
	
	<select id="selectChatList" parameterType="int" resultType="chatDto">
		SELECT A.CHAT_SEQ, A.CHAT_NAME, A.CHAT_CATEGORY, A.CHAT_MAKEDAY, B.MEMBER_SEQ, B.MEMBER_CHAT_OUTTIME FROM CHAT A, MEMBER_CHAT B
		WHERE
			A.CHAT_SEQ = B.CHAT_SEQ
		ORDER BY B.MEMBER_CHAT_OUTTIME DESC
	</select>

</mapper>
